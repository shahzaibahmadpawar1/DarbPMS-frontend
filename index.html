<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" type="image/png" href="/favicon.png" />
  <title>Darb Project Management</title>

  <script>
    const savedLang = localStorage.getItem("darb_lang") || "en";
    document.documentElement.lang = savedLang;
    document.documentElement.dir = savedLang === "ar" ? "rtl" : "ltr";
  </script>

  <style>
    /* 1. HIDE THE TOP BANNER (IFRAME) */
    .goog-te-banner-frame.skiptranslate,
    .goog-te-banner-frame,
    .goog-te-banner,
    .goog-te-balloon-frame,
    #goog-gt-tt,
    .goog-tooltip,
    .goog-tooltip:hover {
      display: none !important;
    }

    /* 2. FIX BODY SHIFT CAUSED BY GOOGLE */
    body {
      top: 0px !important;
      position: static !important;
    }

    /* 3. ROBUSTLY HIDE THE WIDGET using clip-path */
    /* This keeps it in the DOM and functional but completely invisible */
    #google_translate_element {
      position: fixed;
      top: -1000px;
      left: -1000px;
      width: 1px;
      height: 1px;
      clip: rect(0, 0, 0, 0);
      clip-path: inset(50%);
      overflow: hidden;
      white-space: nowrap;
    }
  </style>
</head>

<body>
  <div id="google_translate_element"></div>

  <div id="root"></div>

  <script type="text/javascript">
    function googleTranslateElementInit() {
      // Initialize the widget - it will read the googtrans cookie automatically
      new google.translate.TranslateElement({
        pageLanguage: 'en',
        includedLanguages: 'ar,en',
        autoDisplay: false
      }, 'google_translate_element');
    }
  </script>
  <script type="text/javascript"
    src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

  <script type="text/javascript">
    // Comprehensive banner removal - removes ALL visible Google UI
    function removeBanner() {
      // Remove the main banner iframe
      const bannerFrames = document.querySelectorAll('iframe.goog-te-banner-frame, .goog-te-banner-frame');
      bannerFrames.forEach(frame => frame.remove());

      // Remove any iframe with skiptranslate class that's visible (but not our hidden widget)
      const allIframes = document.querySelectorAll('iframe.skiptranslate');
      allIframes.forEach(iframe => {
        const rect = iframe.getBoundingClientRect();
        // If the iframe is visible (has dimensions and is in viewport), remove it
        if (rect.width > 10 || rect.height > 10) {
          iframe.remove();
        }
      });

      // Remove the banner container div
      const bannerDiv = document.querySelector('.goog-te-banner');
      if (bannerDiv) bannerDiv.remove();

      // Remove tooltips and balloons
      const tooltip = document.querySelector('.goog-tooltip, .goog-te-balloon-frame, #goog-gt-tt');
      if (tooltip) tooltip.remove();

      // Reset body position - Google shifts the body down when showing the banner
      if (document.body.style.top && document.body.style.top !== '0px') {
        document.body.style.top = '0px';
      }

      // Ensure body position is static
      if (document.body.style.position && document.body.style.position !== 'static') {
        document.body.style.position = 'static';
      }
    }

    // Run immediately and frequently
    removeBanner();

    // Run every 50ms for the first 5 seconds to catch the banner as soon as it appears
    let quickCheckCount = 0;
    const quickInterval = setInterval(() => {
      removeBanner();
      quickCheckCount++;
      if (quickCheckCount > 100) { // 50ms * 100 = 5 seconds
        clearInterval(quickInterval);
      }
    }, 50);

    // Watch for DOM changes
    const observer = new MutationObserver(() => {
      removeBanner();
    });
    observer.observe(document.documentElement, {
      childList: true,
      subtree: true
    });

    // Continue checking periodically after initial load
    setInterval(removeBanner, 500);

    // Run on page load
    window.addEventListener('load', removeBanner);

    // Run when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', removeBanner);
    }
  </script>

  <script type="module" src="/src/main.tsx"></script>
</body>

</html>